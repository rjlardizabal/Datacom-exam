trigger:
  - main

pool:
  vmImage: ubuntu-latest

steps:
  - task: JavaToolInstaller@0
    inputs:
      versionSpec: '17'
      jdkArchitectureOption: 'x64'
      jdkSourceOption: AzureStorage
  - script: mvn -B install -D skipTests --no-transfer-progress
    displayName: 'Build and install'
  - script: mvn exec:java -e -D exec.mainClass=com.microsoft.playwright.CLI -D exec.args="install --with-deps"
    displayName: 'Install Playwright browsers'
  - script: mvn test
    displayName: 'Run tests'
  - task: PublishAllureReport@1
    displayName: Publish Report
    inputs:
      allureVersion: 2.27.0
      testResultsDir: allure-results